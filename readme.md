
ä¸€ä¸ªç”¨äºè·å– Minecraft æœåŠ¡å™¨çŠ¶æ€çš„ Node.js API æœåŠ¡ï¼Œæ”¯æŒ Java ç‰ˆå’ŒåŸºå²©ç‰ˆæœåŠ¡å™¨ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ”§ çµæ´»çš„é…ç½®ç³»ç»Ÿ
- ğŸ’¾ æ™ºèƒ½ç¼“å­˜æœºåˆ¶
- ğŸ›¡ï¸ è®¿é—®é€Ÿç‡é™åˆ¶
- ğŸ”’ HTTP/HTTPS åŒåè®®æ”¯æŒ
- ğŸ“Š å¤šç­‰çº§æ—¥å¿—ç³»ç»Ÿ
- ğŸ¯ ç®€å•çš„æœåŠ¡å™¨é…ç½®æ ¼å¼
- â˜• Java ç‰ˆæœåŠ¡å™¨æ”¯æŒ
- ğŸª¨ åŸºå²©ç‰ˆæœåŠ¡å™¨æ”¯æŒ
- ğŸŒ SRV è®°å½•è§£ææ”¯æŒ
- ğŸ“ æ¨¡å—åŒ–ä»£ç ç»“æ„

## é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ app.js          # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ web.js          # WebæœåŠ¡å™¨æ¨¡å—
â”œâ”€â”€ log.js          # æ—¥å¿—æ¨¡å—
â”œâ”€â”€ config.json     # ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ servers.txt     # æœåŠ¡å™¨é…ç½®æ–‡ä»¶
â”œâ”€â”€ package.json    # ä¾èµ–é…ç½®
â”œ# Minecraft æœåŠ¡å™¨çŠ¶æ€ API

ä¸€ä¸ªç”¨äºè·å– Minecraft æœåŠ¡å™¨çŠ¶æ€çš„ Node.js API æœåŠ¡ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ”§ çµæ´»çš„é…ç½®ç³»ç»Ÿ
- ğŸ’¾ æ™ºèƒ½ç¼“å­˜æœºåˆ¶
- ğŸ›¡ï¸ è®¿é—®é€Ÿç‡é™åˆ¶
- ğŸ”’ HTTP/HTTPS åŒåè®®æ”¯æŒ
- ğŸ“Š è¯¦ç»†çš„è®¿é—®æ—¥å¿—
- ğŸ¯ ç®€å•çš„æœåŠ¡å™¨é…ç½®æ ¼å¼

## å®‰è£…å’Œä½¿ç”¨

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. é…ç½®æ–‡ä»¶

#### ä¸»é…ç½®æ–‡ä»¶ (config.json)

```json
{
  "listenIP": "0.0.0.0",           // ç›‘å¬IPåœ°å€
  "http": {
    "enabled": true,               // æ˜¯å¦å¯ç”¨HTTP
    "port": 3000                   // HTTPç«¯å£
  },
  "https": {
    "enabled": false,              // æ˜¯å¦å¯ç”¨HTTPS
    "port": 3443,                  // HTTPSç«¯å£
    "keyPath": "./ssl/private.key", // SSLç§é’¥è·¯å¾„
    "certPath": "./ssl/certificate.crt" // SSLè¯ä¹¦è·¯å¾„
  },
  "cache": {
    "enabled": true,               // æ˜¯å¦å¯ç”¨ç¼“å­˜
    "ttl": 60000                   // ç¼“å­˜è¿‡æœŸæ—¶é—´(æ¯«ç§’)
  },
  "rateLimit": {
    "enabled": true,               // æ˜¯å¦å¯ç”¨é€Ÿç‡é™åˆ¶
    "windowMs": 60000,             // æ—¶é—´çª—å£(æ¯«ç§’)
    "max": 100                     // æœ€å¤§è¯·æ±‚æ¬¡æ•°
  }
}
```

#### æœåŠ¡å™¨é…ç½®æ–‡ä»¶ (servers.txt)

```text
# æœåŠ¡å™¨é…ç½®æ–‡ä»¶
# æ ¼å¼: æœåŠ¡å™¨åç§°=IP:ç«¯å£
# ç«¯å£é»˜è®¤ä¸º25565ï¼Œå¯ä»¥çœç•¥

hypixel=mc.hypixel.net
local=localhost:25565
test=127.0.0.1:25566
```

### 3. å¯åŠ¨æœåŠ¡

```bash
# ç”Ÿäº§ç¯å¢ƒ
npm start

# å¼€å‘ç¯å¢ƒ (éœ€è¦å…ˆå®‰è£… nodemon)
npm run dev
```

## API ç«¯ç‚¹

### GET /health
å¥åº·æ£€æŸ¥ç«¯ç‚¹

**å“åº”ç¤ºä¾‹:**
```json
{
  "status": "ok",
  "timestamp": "2025-08-18T10:30:00.000Z"
}
```

### GET /servers
è·å–æ‰€æœ‰é…ç½®çš„æœåŠ¡å™¨åˆ—è¡¨

**å“åº”ç¤ºä¾‹:**
```json
{
  "servers": ["hypixel", "local", "test"]
}
```

### GET /status/:serverName
è·å–æŒ‡å®šæœåŠ¡å™¨çŠ¶æ€

**å“åº”ç¤ºä¾‹ (åœ¨çº¿):**
```json
{
  "server": "hypixel",
  "online": true,
  "version": {
    "name": "1.8.x-1.20.x",
    "protocol": 47
  },
  "players": {
    "online": 45623,
    "max": 200000
  },
  "description": "Hypixel Network",
  "favicon": "data:image/png;base64,...",
  "ping": 45,
  "timestamp": "2025-08-18T10:30:00.000Z"
}
```

**å“åº”ç¤ºä¾‹ (ç¦»çº¿):**
```json
{
  "server": "offline-server",
  "online": false,
  "error": "connect ECONNREFUSED 127.0.0.1:25565",
  "timestamp": "2025-08-18T10:30:00.000Z"
}
```

### GET /status
è·å–æ‰€æœ‰æœåŠ¡å™¨çŠ¶æ€

**å“åº”ç¤ºä¾‹:**
```json
{
  "hypixel": {
    "server": "hypixel",
    "online": true,
    "version": { "name": "1.8.x-1.20.x", "protocol": 47 },
    "players": { "online": 45623, "max": 200000 },
    "description": "Hypixel Network",
    "ping": 45,
    "timestamp": "2025-08-18T10:30:00.000Z"
  },
  "local": {
    "server": "local",
    "online": false,
    "error": "connect ECONNREFUSED 127.0.0.1:25565",
    "timestamp": "2025-08-18T10:30:00.000Z"
  }
}
```

## ç®¡ç†ç«¯ç‚¹

### POST /admin/cache/clear
æ¸…é™¤æ‰€æœ‰ç¼“å­˜

### POST /admin/reload
é‡æ–°åŠ è½½æœåŠ¡å™¨é…ç½®æ–‡ä»¶

## æ—¥å¿—æ ¼å¼

æ—¥å¿—è¾“å‡ºæ ¼å¼: `æ—¥æœŸæ—¶é—´ æ—¥å¿—ç­‰çº§ å®¢æˆ·ç«¯IP è®¿é—®èµ„æº é™„åŠ ä¿¡æ¯`

**ç¤ºä¾‹:**
```
2025-08-18 10:30:15 INFO 192.168.1.100 /status/hypixel åœ¨çº¿ 45623/200000
2025-08-18 10:30:16 WARN 192.168.1.101 /status/offline ç¦»çº¿ - connect ECONNREFUSED
2025-08-18 10:30:17 INFO 192.168.1.102 /status/hypixel è¿”å›ç¼“å­˜æ•°æ®
```

## é…ç½®è¯´æ˜

### ä¸»é…ç½® (config.json)

- **listenIP**: æœåŠ¡å™¨ç›‘å¬çš„IPåœ°å€ï¼Œä½¿ç”¨ "0.0.0.0" ç›‘å¬æ‰€æœ‰æ¥å£
- **http.enabled**: æ˜¯å¦å¯ç”¨HTTPæœåŠ¡
- **https.enabled**: æ˜¯å¦å¯ç”¨HTTPSæœåŠ¡ï¼Œéœ€è¦SSLè¯ä¹¦
- **cache.enabled**: æ˜¯å¦å¯ç”¨å“åº”ç¼“å­˜
- **cache.ttl**: ç¼“å­˜ç”Ÿå­˜æ—¶é—´ï¼Œå•ä½æ¯«ç§’
- **rateLimit.enabled**: æ˜¯å¦å¯ç”¨è®¿é—®é€Ÿç‡é™åˆ¶
- **rateLimit.windowMs**: é€Ÿç‡é™åˆ¶æ—¶é—´çª—å£
- **rateLimit.max**: æ—¶é—´çª—å£å†…æœ€å¤§è¯·æ±‚æ¬¡æ•°

### æœåŠ¡å™¨é…ç½® (servers.txt)

- æ¯è¡Œä¸€ä¸ªæœåŠ¡å™¨é…ç½®
- æ ¼å¼: `æœåŠ¡å™¨åç§°=ä¸»æœº:ç«¯å£`
- ç«¯å£å¯é€‰ï¼Œé»˜è®¤ 25565
- æ”¯æŒæ³¨é‡Šè¡Œ (ä»¥ # å¼€å¤´)
- æ”¯æŒç©ºè¡Œ

## å®‰å…¨æ³¨æ„äº‹é¡¹

1. åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå»ºè®®ï¼š
   - å¯ç”¨HTTPS
   - è®¾ç½®é€‚å½“çš„é€Ÿç‡é™åˆ¶
   - é™åˆ¶ç®¡ç†ç«¯ç‚¹çš„è®¿é—®æƒé™
   - ä½¿ç”¨åå‘ä»£ç† (å¦‚ Nginx)

2. SSLè¯ä¹¦é…ç½®ï¼š
   - å°†SSLè¯ä¹¦æ”¾åœ¨ `./ssl/` ç›®å½•ä¸‹
   - ç§é’¥æ–‡ä»¶: `private.key`
   - è¯ä¹¦æ–‡ä»¶: `certificate.crt`

## æ•…éšœæ’é™¤

1. **ç«¯å£è¢«å ç”¨**: ä¿®æ”¹ config.json ä¸­çš„ç«¯å£é…ç½®
2. **SSLè¯ä¹¦é”™è¯¯**: æ£€æŸ¥è¯ä¹¦è·¯å¾„å’Œæƒé™
3. **æœåŠ¡å™¨æ— æ³•è¿æ¥**: æ£€æŸ¥ servers.txt ä¸­çš„æœåŠ¡å™¨åœ°å€å’Œç«¯å£
4. **ç¼“å­˜é—®é¢˜**: ä½¿ç”¨ `/admin/cache/clear` æ¸…é™¤ç¼“å­˜

## å¼€å‘

å¦‚æœéœ€è¦æ·»åŠ æ–°åŠŸèƒ½æˆ–ä¿®æ”¹ç°æœ‰åŠŸèƒ½ï¼Œä¸»è¦çš„ä»£ç é€»è¾‘åœ¨ `app.js` æ–‡ä»¶ä¸­çš„ `MCStatusAPI` ç±»ã€‚